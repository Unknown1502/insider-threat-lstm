#
# Insider Threat Detection Props Configuration
#

[cert_email]
DATETIME_CONFIG = 
INDEXED_EXTRACTIONS = csv
KV_MODE = none
LINE_BREAKER = ([\r\n]+)
NO_BINARY_CHECK = true
SHOULD_LINEMERGE = false
TIMESTAMP_FIELDS = date
TIME_FORMAT = %m/%d/%Y %H:%M:%S
TZ = UTC
category = Structured
description = CERT Insider Threat Email Dataset
pulldown_type = 1
TRANSFORMS-cert_email_extract = cert_email_extract
TRANSFORMS-email_cim_mapping = email_cim_mapping
LOOKUP-threat_indicators = insider_threat_lookup user OUTPUT risk_level, threat_category
EVAL-is_external = if(match(to, ".*@(?!.*dtaa\.com).*"), 1, 0)
EVAL-is_large_email = if(size > 10000000, 1, 0)
EVAL-is_many_attachments = if(attachments > 5, 1, 0)
EVAL-hour = strftime(_time, "%H")
EVAL-day_of_week = strftime(_time, "%w")
EVAL-is_after_hours = if(hour < 7 OR hour > 19, 1, 0)
EVAL-is_weekend = if(day_of_week == 0 OR day_of_week == 6, 1, 0)

[insider_threat_alert]
DATETIME_CONFIG = 
INDEXED_EXTRACTIONS = json
KV_MODE = json
LINE_BREAKER = ([\r\n]+)
NO_BINARY_CHECK = true
SHOULD_LINEMERGE = false
TIMESTAMP_FIELDS = timestamp
TIME_FORMAT = %Y-%m-%dT%H:%M:%S
TZ = UTC
category = Security
description = Insider Threat Detection Alerts
pulldown_type = 1
TRANSFORMS-user_risk_score = user_risk_score
TRANSFORMS-threat_classification = threat_classification
EVAL-severity = case(threat_score >= 0.9, "critical", threat_score >= 0.7, "high", threat_score >= 0.5, "medium", 1=1, "low")
EVAL-alert_time = strftime(_time, "%Y-%m-%d %H:%M:%S")

[insider_threat_log]
DATETIME_CONFIG = 
INDEXED_EXTRACTIONS = 
KV_MODE = auto
LINE_BREAKER = ([\r\n]+)
NO_BINARY_CHECK = true
SHOULD_LINEMERGE = false
TIMESTAMP_FIELDS = timestamp
TIME_FORMAT = %Y-%m-%d %H:%M:%S
TZ = UTC
category = Application
description = Insider Threat Detection Application Logs
pulldown_type = 1

[auth_event]
DATETIME_CONFIG = 
INDEXED_EXTRACTIONS = 
KV_MODE = auto
LINE_BREAKER = ([\r\n]+)
NO_BINARY_CHECK = true
SHOULD_LINEMERGE = false
TIMESTAMP_FIELDS = timestamp
TIME_FORMAT = %Y-%m-%dT%H:%M:%S
TZ = UTC
category = Security
description = Authentication Events for Insider Threat Detection
pulldown_type = 1
TRANSFORMS-auth_cim_mapping = auth_cim_mapping
EVAL-success = if(match(auth_result, "(?i)success|pass|ok"), 1, 0)
EVAL-failure = if(match(auth_result, "(?i)fail|error|deny"), 1, 0)
EVAL-is_admin = if(match(user, "(?i)admin|root"), 1, 0)
EVAL-is_external_ip = if(NOT match(src_ip, "^(10\.|192\.168\.|172\.(1[6-9]|2[0-9]|3[0-1])\.)"), 1, 0)

[web_event]
DATETIME_CONFIG = 
INDEXED_EXTRACTIONS = 
KV_MODE = auto
LINE_BREAKER = ([\r\n]+)
NO_BINARY_CHECK = true
SHOULD_LINEMERGE = false
TIMESTAMP_FIELDS = timestamp
TIME_FORMAT = %Y-%m-%dT%H:%M:%S
TZ = UTC
category = Web
description = Web Events for Insider Threat Detection
pulldown_type = 1
EVAL-is_error = if(status >= 400, 1, 0)
EVAL-is_large_transfer = if(bytes > 100000000, 1, 0)
EVAL-is_suspicious_method = if(match(method, "(?i)DELETE|PUT|PATCH"), 1, 0)
